
0、操作系统
   https://blog.csdn.net/csshuke/article/details/78843777
   操作系统无非由以下四大部分组成（熟记这四个模块）：

                   1.任务调度

                   2.内存管理

                   3.文件系统

                   4. I/O

     对于主流的操作系统而言，这四个缺一不可！！，
     而对于一些非常简单的实时操作系统可能会没有3和4。

     px4所使用的的Nuttx这四个模块都有。

     a. 任务调度：（宏观决策） 
        什么是任务调度（很多课本上会说进程管理，但后面操作系统发展出了线程，这个说法其实不严谨）？
        简单点说任务调度就是一个程序，这个程序决定其他程序什么时候使用CPU，什么时候挂起。
     
     b. 优先级：(VIP贵宾服务,后门，关系)
        高优先级task抢低优先级task （即使这个task在用CPU）CPU，对于高优先级的程序，
        要求系统有快速的反映时间（这是衡量一个实时操作系统好坏的主要标准）。

     c. 内存管理：（国家国土资源部）
        程序要运行首先要干嘛？要把它从ROM（可理解为硬盘）里面加载到RAM（可理解为内存）里面。
        如果单片机就跑一个程序，整个内存都是你的，你想怎么用就怎么用。
        可是引入操作系统后，要对多个task进行调度，就得把他们全部加载到内存中，
        可是毕竟单片机或者mcu的内存有限（即使电脑的也有限），这就引出了内存管理。
        
        简单点说内存管理也是一个程序，这个程序决定谁驻留在内存，谁离开内存。
      
     d.文件系统 （国家发展改革委）
        在ROM里面保存的东西，如果是少量的东西，你可以随便保存。
        可是当你有几十个g种子的时候，你也直接用单片机的方式一个一个写到flash里面！！！
        你杂乱无章的保存会导致后面查找，删除，修改变得非常麻烦，
        使用我们要用文件系统来帮我们管理这些个文件，
        而我们只要对文件系统进行操作就能对文件操作了。

        简单点说文件系统是一个程序，它帮我们管理我们的文件，使我们操作文件更方便。

      e. I/O    （国家进出口）
         CPU不能独立的存在，它得和周围的设备通信，内存也好，flash也罢，这些都可以通归为I/O设备。
         对于px4来说I/O设备就更多了，什么gps，陀螺仪，加速计，气压计，空速计，pmm输入等等，还在一直加呢！
         我们自己写个main数，也可以读出这些设备的数据，但在操作系统中，对这些设备进行操作就不是那么简单了。
         由于I/O算的上计算机组件当中最复杂的东西了，你不能简简单单把它归类为某个程序。
          
         Unix系统对I/O设备有个很好的抽象：文件。
             Unix系统中把所有东西都抽象成文件，I/O设备是一种特殊的文件。
             因为事实上我们并不关心你I/O设备是什么，我们只想要其中的数据，
             文件可以存取数据，传感器数据不断更新，我就不断更新这个文件内容，
             其他程序想要里面的数据可以去读这个文件就行。

      f. px4的 实时操作系统 Nuttx
   
         首先说说px4和Nuttx的渊源：
             PX4是一个软、硬件开源项目（遵守BSD协议），目的在于为学术、爱好和工业团体提供一款低成本高性能的高端的自驾仪。
             这个项目源于 ETH Zurich (苏黎世联邦理工大学)的计算机视觉与几何实验室的PIXHAWK项目,
             并得到了自主系统实验室和 自动控制实验室的支持。
             而Nuttx也是苏黎世联邦理工大学的一个开源项目（这个学校在计算机方面可能算的上是欧洲最强的了，
             那个提出最短路径算法和信号量的教授就是这个学校的）。所以他们两个就走到了一起。

             下面背下书：
                 NuttX 是一个实时操作系统（RTOS），强调标准兼容和小型封装，具有从8位到32位微控制器环境的高度可扩展性。
                 NuttX 主要遵循  Posix 和 ANSI 标准，对于在这些标准下不支持的功能，
                 或者不适用于深度嵌入环境的功能（如 fork()），
                 采用来自 Unix 和常见 RTOS （如 VxWorks）的额外的标准 API。   



1、为何选择 nuttx 实时嵌入式系统

	裸机程序，不能处理太复杂的逻辑，系统越复杂，越需要上os
	freertos, 不支持 posix api
	rtems是gpl版权
	nuttx bsd版权，px4和apm开源飞控都使用nuttx, 经过验证的很好用的系统，posix api
	所以选择nuttx是合理的
	但nuttx tcp/ip协议栈稳定吗？GUI呢？不知道

还有一个最重要的原因freertos不支持动态加载程序，而nuttx支持！


2、freeRTOS比uCOSII优胜的地方：　

　a. 内核ROM和耗费RAM都比uCOS小，特别是RAM。这在单片机里面是稀缺资源，uCOS至少要5K以上，而freeOS用2~3K也可以跑的很好。　
　b. freeRTOS可以用协程（Co-routine），减少RAM消耗（共用STACK）。uCOS只能用任务（TASK，每个任务有一个独立的STACK）。　
　c. freeRTOS可以有优先度一样的任务，这些任务是按时间片来轮流处理，uCOSII每个任务都只有一个独一无二的优先级。
     因此，理论上讲，freeRTOS可以管理超过64个任务，而uCOS只能管理64个。　　
  d. freeRTOS是在商业上免费应用。uCOS在商业上的应用是要付钱的。　
　
3、freeRTOS不如uCOS的地方：　　

  a. 比uSOS简单，任务间通讯freeRTOS只支持Queque，Semaphores，Mutex。
     uCOS除这些外，还支持Flag,MailBox.　　

  b. uCOS的支持比freeRTOS多。
     除操作系统外，freeRTOS只支持TCPIP，uCOS则有大量外延支持，比如FS，USB，GUI，CAN等的支持.
　　
  c. uCOS可靠性更高，而且耐优化，freeRTOS在我设置成中等优化的时候，就会出问题。



4、px4原生固件模块列表：

a. 系统命令程序

	mavlink C通过串口发送和接收mavlink信息

	sdlog2 C保存系统日志/飞行数据到SD卡

	tests  C测试系统中的测试程序

	top C列出当前的进程和CPU负载

	uORB C 微对象请求代理器-分发其他应用程序之间的信息

b. 驱动

	mkblctrlCblctrl电子模块驱动

	esc_calib CESC的校准工具

	fmu CFMU引脚输入输出定义

	gpio_led CGPIO

c. LED驱动

	gps CGPS接收器驱动

	pwm CPWM的更新速率命令

d. sensors C传感器应用

e. px4io Cpx4io驱动

f. uavcan Cuavcan驱动

	飞行控制的程序
	飞行安全和导航

h. commander C主要飞行安全状态机    可进行修改 功能

i. navigator C任务，失效保护和RTL导航仪

j. 估计姿态和位置

	attitude_estimator_ekf C基于EKF的姿态估计

	ekf_att_pos_estimator C基于EKF的姿态和位置估计

	position_estimator_inavC惯性导航的位置估计


k. multirotor  姿态和位置控制器

	mc_att_controlCmultirotor 姿态控制器

	mc_pos_control Cmultirotor位置控制器


l. fixedwing姿态和位置控制器

	fw_att_control C固定翼飞机的姿态控制

	fw_pos_control_l1 C固定翼位置控制器

m. 垂直起降姿态控制器

	vtol_att_control C垂直起降姿态控制器